' Gambas class file

Inherits CadArc

Public Const Gender As String = "ARC3POINT"
Public X1 As Float
Public y1 As Float
Public X2 As Float
Public y2 As Float
Public X3 As Float
Public y3 As Float
Public Const ParamType As String = "PPP"
Public Const ParamHelper As String = "Point1;Point2;Point3"      ' a little text that is shown at the prompt waiting for user input during build
Public Const ParamDefault As String = "0,0;0,0;0,0"

Public Function NewParameter(eBuild As Entity, vParam As Variant[], Optional Definitive As Boolean = False) As Boolean

    If gcd.StepsDone = 0 Then

        If vParam[0] <> "point" Then Return False

        Try x1 = vParam[1]
        Try y1 = vParam[2]

        If definitive Then
            eBuild.fParam.Add(0)
            Return True
        End If
    Else If gcd.StepsDone = 1 Then   ' radio

        If vParam[0] <> "point" Then Return False

        Try x2 = vParam[1]
        Try y2 = vParam[2]

        If definitive Then Return True

    Else If gcd.StepsDone = 2 Then

        If vParam[0] <> "point" Then Return False

        Try x3 = vParam[1]
        Try y3 = vParam[2]

        If definitive Then Return True

    Else
        Return False
    End If

End

Public Sub makepolyline(oe As Entity)

    If gcd.StepsDone = 0 Then Return
    oe.PolyLine.Clear

    If gcd.StepsDone = 1 Then

        oe.PolyLine.Insert([x1, y1, x2, y2])
        Return
    Endif

    Dim flx As New Float[]
    flx = puntos.Arc3Point(x1, y1, x2, y2, x3, y3)

    oe.P[0] = flx[0]
    oe.P[1] = flx[1]
    oE.fParam[0] = flx[2]
    oE.fParam[1] = Deg(flx[3])
    oE.fParam[2] = Deg(flx[3] + flx[4])

    Super.makepolyline(oe)

End

Public Sub Draw(oE As Entity)

    Dim x, y, theta, angle_increment As Float
    Dim i As Integer

    Dim major, minor, angle, la As Float

    Dim LargoPixels, LargoReal, EscalaTramos As Float

    If Not oE.Visible Then Return

    Me.makepolyline(oe)

    glx.PolyLines(oe.PolyLine, gcd.GetGBColor(oE.Colour, oe.pLayer), gcd.GetLineWt(oE.LineWIdth, oe.pLayer), oE.LineType.TrameLength)

End

Public Sub Finish(oE As Entity) As Boolean

    ' aca vamos a trasnformar la entidad en una polilinea

    oe.gender = cadArc.Gender

    oE.psel.resize(oE.p.count / 2)

End
